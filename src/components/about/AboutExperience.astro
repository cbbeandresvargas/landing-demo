---
// AboutExperience.astro - Experience timeline section for About page
import { getLangFromUrl } from "@i18n/utils";
import { getExperience } from "@utils/data";

const lang = getLangFromUrl(Astro.url);
const experienceData = getExperience(lang);
---

<!-- Experience Timeline -->
<section class="about-experience section home-dark-section py-20">
	<div class="col-span-12">
		<div class="max-w-4xl mx-auto">
			<h2 class="text-4xl font-bold mb-16 text-center font-display">
				{lang === 'es' ? 'Experiencia y Roles Clave' : 'Experience & Key Roles'}
			</h2>
			<div class="space-y-12">
				{experienceData.map((experience: any) => (
					<div class="experience-item border-l-2 border-slate-300 pl-8 relative">
						<div class="absolute -left-2 top-0 w-4 h-4 bg-slate-300 rounded-full"></div>
						<div>
							<h3 class="text-2xl font-bold mb-2 text-black">
								{experience.title}
							</h3>
							<p class="text-lg text-slate-400 mb-2">{experience.company}</p>
							<p class="text-sm text-slate-500 mb-4">
								{experience.period}
							</p>
							<p class="text-slate-300">
								{experience.description}
							</p>
						</div>
					</div>
				))}
			</div>
		</div>
	</div>
</section>

<script>
	import { gsap } from "gsap";
	import { ScrollTrigger } from "gsap/ScrollTrigger";

	gsap.registerPlugin(ScrollTrigger);

	function init() {
		// Animate title
		gsap.from('.about-experience h2', {
			scrollTrigger: {
				trigger: '.about-experience',
				start: "top 80%",
				end: "bottom 20%",
				toggleActions: "play none none reverse"
			},
			duration: 0.8,
			y: 50,
			opacity: 0,
			ease: "power2.out"
		});

		// Animate experience items
		gsap.from('.about-experience .experience-item', {
			scrollTrigger: {
				trigger: '.about-experience',
				start: "top 70%",
				end: "bottom 20%",
				toggleActions: "play none none reverse"
			},
			duration: 0.8,
			y: 50,
			opacity: 0,
			ease: "power2.out",
			stagger: 0.2
		});
	}

	document.removeEventListener("DOMContentLoaded", init);
	document.addEventListener("DOMContentLoaded", init);
</script>
