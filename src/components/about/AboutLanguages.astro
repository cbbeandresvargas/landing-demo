---
// AboutLanguages.astro - Languages section for About page
import { getLangFromUrl } from "@i18n/utils";
import { getLanguages } from "@utils/data";

const lang = getLangFromUrl(Astro.url);
const languagesData = getLanguages(lang);

// Icon component function - using flag emojis for simplicity
function getIcon(flag: string) {
	return `<div class="text-4xl">${flag}</div>`;
}
---

<!-- Languages Section -->
<section class="about-languages section py-20">
	<div class="col-span-12">
		<div class="max-w-4xl mx-auto text-center">
			<h2 class="text-4xl font-bold mb-16 font-display">
				{lang === 'es' ? 'Idiomas' : 'Languages'}
			</h2>
			<div class="grid grid-cols-1 md:grid-cols-3 gap-8">
				{languagesData.map((language: any) => (
					<div class="language-card">
						<div class="mb-4" set:html={getIcon(language.flag)}></div>
						<h3 class="text-xl font-bold mb-2 text-black">
							{language.name}
						</h3>
						<p class="text-slate-600">
							{language.level}
						</p>
						<div class="mt-2">
							<div class="w-full bg-slate-200 rounded-full h-2">
								<div class="bg-slate-600 h-2 rounded-full" style={`width: ${language.proficiency}%`}></div>
							</div>
							<p class="text-xs text-slate-500 mt-1">{language.proficiency}%</p>
						</div>
					</div>
				))}
			</div>
		</div>
	</div>
</section>

<script>
	import { gsap } from "gsap";
	import { ScrollTrigger } from "gsap/ScrollTrigger";

	gsap.registerPlugin(ScrollTrigger);

	function init() {
		// Animate title
		gsap.from('.about-languages h2', {
			scrollTrigger: {
				trigger: '.about-languages',
				start: "top 80%",
				end: "bottom 20%",
				toggleActions: "play none none reverse"
			},
			duration: 0.8,
			y: 50,
			opacity: 0,
			ease: "power2.out"
		});

		// Animate language cards
		gsap.from('.about-languages .language-card', {
			scrollTrigger: {
				trigger: '.about-languages',
				start: "top 70%",
				end: "bottom 20%",
				toggleActions: "play none none reverse"
			},
			duration: 0.8,
			y: 50,
			opacity: 0,
			ease: "power2.out",
			stagger: 0.2
		});
	}

	document.removeEventListener("DOMContentLoaded", init);
	document.addEventListener("DOMContentLoaded", init);
</script>
